{"version":3,"sources":["common/decorators.js"],"names":["generateBindables","controlName","inputs","twoWayProperties","abbrevProperties","target","key","descriptor","behaviorResource","metadata","getOrCreateOwn","resource","HtmlBehaviorResource","container","Container","instance","util","get","Util","push","len","length","prototype","twoWays","controlProperties","i","option","nameOrConfigOrTarget","name","getBindablePropertyName","defaultBindingMode","bindingMode","twoWay","prop","BindableProperty","registerWith","delayed","taskQueue","TaskQueue","ptr","value","args","childPropertyName","queueTask","apply"],"mappings":";;;;;;AAOO,WAASA,iBAAT,CAA2BC,WAA3B,EAAwCC,MAAxC,EAAgDC,gBAAhD,EAAkEC,gBAAlE,EAAoF;AACzF,WAAO,UAASC,MAAT,EAAiBC,GAAjB,EAAsBC,UAAtB,EAAkC;AACvC,UAAIC,mBAAmBC,SAASC,cAAT,CAAwBD,SAASE,QAAjC,EAA2CC,oBAA3C,EAAiEP,MAAjE,CAAvB;AACA,UAAIQ,YAAaC,UAAUC,QAAV,IAAsB,IAAID,SAAJ,EAAvC;AACA,UAAIE,OAAOH,UAAUI,GAAV,CAAcC,IAAd,CAAX;AACAhB,aAAOiB,IAAP,CAAY,SAAZ;AACAjB,aAAOiB,IAAP,CAAY,QAAZ;AACA,UAAIC,MAAMlB,OAAOmB,MAAjB;AACAhB,aAAOiB,SAAP,CAAiBrB,WAAjB,GAA+BA,WAA/B;AACAI,aAAOiB,SAAP,CAAiBC,OAAjB,GAA2BpB,mBAAmBA,gBAAnB,GAAsC,EAAjE;AACAE,aAAOiB,SAAP,CAAiBlB,gBAAjB,GAAoCA,mBAAmBA,gBAAnB,GAAsC,EAA1E;AACA,UAAIgB,GAAJ,EAAS;AACPf,eAAOiB,SAAP,CAAiBE,iBAAjB,GAAqCtB,MAArC;AACA,aAAK,IAAIuB,IAAI,CAAb,EAAgBA,IAAIL,GAApB,EAAyBK,GAAzB,EAA8B;AAC5B,cAAIC,SAASxB,OAAOuB,CAAP,CAAb;AACA,cAAIrB,oBAAoBsB,UAAUtB,gBAAlC,EAAoD;AAClDsB,qBAAStB,iBAAiBsB,MAAjB,CAAT;AACD;AACD,cAAIC,uBAAuB;AACzBC,kBAAMZ,KAAKa,uBAAL,CAA6BH,MAA7B;AADmB,WAA3B;;AAIA,cAAIA,WAAW,QAAf,EAAyB;AACvBC,iCAAqBG,kBAArB,GAA0CC,YAAYC,MAAtD;AACD;;AAED,cAAIC,OAAO,IAAIC,gBAAJ,CAAqBP,oBAArB,CAAX;AACAM,eAAKE,YAAL,CAAkB9B,MAAlB,EAA0BG,gBAA1B,EAA4CD,UAA5C;AACD;AACF;AACF,KA7BD;AA8BD;;+BA/BeP,iB;;AAiCT,WAASoC,OAAT,GAAmB;AACxB,WAAO,UAAS/B,MAAT,EAAiBC,GAAjB,EAAsBC,UAAtB,EAAkC;AACvC,UAAI8B,YAAY,CAACvB,UAAUC,QAAV,IAAsB,IAAID,SAAJ,EAAvB,EAAwCG,GAAxC,CAA4CqB,SAA5C,CAAhB;AACA,UAAIC,MAAMhC,WAAWiC,KAArB;;AAEAjC,iBAAWiC,KAAX,GAAmB,YAAkB;AAAA;;AAAA,0CAANC,IAAM;AAANA,cAAM;AAAA;;AACnC,YAAI,KAAKC,iBAAT,EAA4B;AAC1BL,oBAAUM,SAAV,CAAoB;AAAA,mBAAMJ,IAAIK,KAAJ,QAAgBH,IAAhB,CAAN;AAAA,WAApB;AACD,SAFD,MAEM;AACJF,cAAIK,KAAJ,CAAU,IAAV,EAAgBH,IAAhB;AACD;AACF,OAND;;AAQA,aAAOlC,UAAP;AACD,KAbD;AAcD;;qBAfe6B,O;;;;AAxCRF,sB,sBAAAA,gB;AAAkBtB,0B,sBAAAA,oB;;AAClBE,e,+BAAAA,S;;AACAL,c,oBAAAA,Q;;AACA6B,e,qBAAAA,S;;AACCP,iB,mBAAAA,W;;AACAb,U,SAAAA,I","file":"../../../common/decorators.js","sourcesContent":["import {BindableProperty, HtmlBehaviorResource} from 'aurelia-templating';\r\nimport {Container} from 'aurelia-dependency-injection';\r\nimport {metadata} from 'aurelia-metadata';\r\nimport {TaskQueue} from 'aurelia-task-queue';\r\nimport { bindingMode } from 'aurelia-binding';\r\nimport { Util } from './util';\r\n\r\nexport function generateBindables(controlName, inputs, twoWayProperties, abbrevProperties) {\r\n  return function(target, key, descriptor) {\r\n    let behaviorResource = metadata.getOrCreateOwn(metadata.resource, HtmlBehaviorResource, target);\r\n    let container = (Container.instance || new Container());\r\n    let util = container.get(Util);\r\n    inputs.push('options');\r\n    inputs.push('widget');\r\n    let len = inputs.length;\r\n    target.prototype.controlName = controlName;\r\n    target.prototype.twoWays = twoWayProperties ? twoWayProperties : [];\r\n    target.prototype.abbrevProperties = abbrevProperties ? abbrevProperties : [];\r\n    if (len) {\r\n      target.prototype.controlProperties = inputs;\r\n      for (let i = 0; i < len; i++) {\r\n        let option = inputs[i];\r\n        if (abbrevProperties && option in abbrevProperties) {\r\n          option = abbrevProperties[option];\r\n        }\r\n        let nameOrConfigOrTarget = {\r\n          name: util.getBindablePropertyName(option)\r\n        };\r\n\r\n        if (option === 'widget') {\r\n          nameOrConfigOrTarget.defaultBindingMode = bindingMode.twoWay;\r\n        }\r\n\r\n        let prop = new BindableProperty(nameOrConfigOrTarget);\r\n        prop.registerWith(target, behaviorResource, descriptor);\r\n      }\r\n    }\r\n  };\r\n}\r\n\r\nexport function delayed() {\r\n  return function(target, key, descriptor) {\r\n    let taskQueue = (Container.instance || new Container()).get(TaskQueue);\r\n    let ptr = descriptor.value;\r\n\r\n    descriptor.value = function(...args) {\r\n      if (this.childPropertyName) {\r\n        taskQueue.queueTask(() => ptr.apply(this, args));\r\n      }else {\r\n        ptr.apply(this, args);\r\n      }\r\n    };\r\n\r\n    return descriptor;\r\n  };\r\n}\r\n"]}